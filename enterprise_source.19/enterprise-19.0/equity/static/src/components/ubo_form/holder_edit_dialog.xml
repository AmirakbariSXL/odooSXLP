<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="equity.HolderEditDialog">
        <Dialog title="title" size="'md'">
            <div class="o_holder_edit_dialog">
                <div class="text-danger">
                    <t t-foreach="submitErrors" t-as="submitError" t-key="submitError_index">
                        <p t-out="submitError"/>
                    </t>
                </div>

                <label class="col-form-label">Name</label>
                <input class="form-control" t-model="state.newUbo.holder_id.name"/>

                <label class="col-form-label">Nationality</label>
                <select class="form-select" t-model="state.newUbo.holder_id.country_id">
                    <option value=""/>
                    <t t-foreach="Object.keys(this.props.allCountries)" t-as="countryId" t-key="countryId">
                        <option
                            t-att-value="countryId"
                            t-att-selected="countryId == this.state.newUbo.holder_id.country_id"
                            t-out="this.props.allCountries[countryId]"
                        />
                    </t>
                </select>

                <label class="col-form-label">Birth Date</label>
                <input class="form-control" type="date" t-model="state.newUbo.holder_id.ubo_birth_date"/>

                <label class="col-form-label">Birth Place</label>
                <input class="form-control" t-model="state.newUbo.holder_id.ubo_birth_place"/>

                <label class="col-form-label">ID Number</label>
                <input class="form-control" t-model="state.newUbo.holder_id.ubo_national_identifier"/>

                <label class="col-form-label">Politically Exposed Person</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" t-model="state.newUbo.holder_id.ubo_pep"/>
                </div>

                <label class="col-form-label">Supporting Document</label>
                <div t-if="state.newUbo.attachment" class="m-2">
                    <t t-out="state.newUbo.attachment.name"/>
                </div>
                <div>
                    <FileUploader onUploaded.bind="onFileUpload">
                        <t t-set-slot="toggler">
                            <button
                                class="btn btn-secondary fa fa-upload mx-1"
                                data-tooltip="Upload"
                                aria-label="Upload"
                            />
                        </t>
                        <button
                            t-if="state.newUbo.attachment"
                            t-on-click="onFileRemove"
                            class="btn btn-secondary fa fa-trash mx-1"
                            data-tooltip="Clear"
                            aria-label="Clear"
                        />
                    </FileUploader>
                </div>

                <label class="col-form-label">Document Expiration Date</label>
                <input class="form-control" type="date" t-model="state.newUbo.attachment_expiration_date"/>

                <label class="col-form-label">Control Start Date</label>
                <input class="form-control mb-2" type="date" t-model="state.newUbo.start_date"/>

                <label class="col-form-label">Controlling Method</label>
                <select class="form-select" t-model="state.newUbo.control_method" t-on-change="onchangeControlMethod">
                    <t t-foreach="Object.keys(this.controlMethods)" t-as="controlMethod" t-key="controlMethod">
                        <option
                            t-att-value="controlMethod"
                            t-out="this.controlMethods[controlMethod]"
                        />
                    </t>
                </select>

                <t t-if="showPercentages">
                    <label class="col-form-label">Ownership</label>
                    <div class="d-flex">
                        <input class="form-control w-15" type="number" t-att-value="formatPercentage(state.newUbo.ownership)" t-on-change="onchangeOwnership"/>
                        <span class="px-1 py-2">%</span>
                    </div>

                    <label class="col-form-label">Voting Rights</label>
                    <div class="d-flex">
                        <input class="form-control w-15" type="number" t-att-value="formatPercentage(state.newUbo.voting_rights)" t-on-change="onchangeVotingRights"/>
                        <span class="px-1 py-2">%</span>
                    </div>
                </t>
                <t t-if="showRole">
                    <label class="col-form-label">Authorized Representative Role</label>
                    <select class="form-select" t-model="state.newUbo.auth_rep_role">
                        <option value=""/>
                        <t t-foreach="Object.keys(this.authRepRoles)" t-as="authRepRole" t-key="authRepRole">
                            <option
                                t-att-value="authRepRole"
                                t-out="this.authRepRoles[authRepRole]"
                            />
                        </t>
                    </select>
                </t>
            </div>
            <t t-set-slot="footer">
                <button class="btn btn-primary" t-if="!submitErrors.length" t-on-click="confirm" t-out="props.isNew ? 'Add Person' : 'Submit changes'"/>
                <button class="btn btn-secondary" t-on-click="this.props.close">Discard</button>
            </t>
        </Dialog>
    </t>
</templates>
